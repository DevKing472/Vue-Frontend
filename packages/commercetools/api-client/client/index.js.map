{"version":3,"file":"index.js","sources":["../src/helpers/apiClient/defaultSettings.ts","../src/helpers/utils.ts","../src/api/isGuest/index.ts","../src/index.client.ts"],"sourcesContent":["export const defaultSettings = {\n  locale: 'en',\n  acceptLanguage: ['en'],\n  auth: {\n    onTokenChange: () => {},\n    onTokenRead: () => '',\n    onTokenRemove: () => {}\n  },\n  cookies: {\n    currencyCookieName: 'vsf-currency',\n    countryCookieName: 'vsf-country',\n    localeCookieName: 'vsf-locale'\n  }\n};\n","export const isAnonymousSession = (token) => token?.scope?.includes('anonymous_id');\nexport const isUserSession = (token) => token?.scope?.includes('customer_id');\nexport const getAccessToken = (token) => token ? token.access_token : null;\n","import { isAnonymousSession, isUserSession } from '../../helpers/utils';\n\nconst isGuest = (context) => {\n  const { client, config } = context;\n\n  if (config.handleIsGuest) {\n    return config.handleIsGuest(context);\n  }\n\n  if (client.tokenProvider || context.isProxy) {\n    const token = config.auth.onTokenRead();\n    return !isAnonymousSession(token) && !isUserSession(token);\n  }\n\n  return false;\n};\n\nexport default isGuest;\n","import { apiProxyFactory } from '@vue-storefront/core';\nimport { defaultSettings } from './helpers/apiClient/defaultSettings';\nimport isGuest from './api/isGuest';\n\nconst onCreate = (settings: any) => {\n  const languageMap = settings.languageMap || {};\n  const acceptLanguage = settings.acceptLanguage || defaultSettings.acceptLanguage;\n  const locale = settings.locale || defaultSettings.locale;\n\n  const config = {\n    ...defaultSettings,\n    ...settings,\n    languageMap,\n    acceptLanguage: languageMap[locale] || acceptLanguage,\n    auth: settings.auth || defaultSettings.auth\n  } as any;\n\n  return { config };\n};\n\nconst { createApiProxy, integrationPlugin } = apiProxyFactory({\n  tag: 'ct',\n  onCreate,\n  api: { isGuest }\n});\n\nexport {\n  createApiProxy,\n  integrationPlugin\n};\n"],"names":["apiProxyFactory"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,IAAM,eAAe,GAAG;IAC7B,MAAM,EAAE,IAAI;IACZ,cAAc,EAAE,CAAC,IAAI,CAAC;IACtB,IAAI,EAAE;QACJ,aAAa,EAAE,eAAQ;QACvB,WAAW,EAAE,cAAM,OAAA,EAAE,GAAA;QACrB,aAAa,EAAE,eAAQ;KACxB;IACD,OAAO,EAAE;QACP,kBAAkB,EAAE,cAAc;QAClC,iBAAiB,EAAE,aAAa;QAChC,gBAAgB,EAAE,YAAY;KAC/B;CACF;;ACbM,IAAM,kBAAkB,GAAG,UAAC,KAAK,yBAAK,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,QAAQ,CAAC,cAAc,IAAC,CAAC;AACpF,AAAO,IAAM,aAAa,GAAG,UAAC,KAAK,yBAAK,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,QAAQ,CAAC,aAAa,IAAC,CAAC;;ACC9E,IAAM,OAAO,GAAG,UAAC,OAAO;IACd,IAAA,MAAM,GAAa,OAAO,OAApB,EAAE,MAAM,GAAK,OAAO,OAAZ,CAAa;IAEnC,IAAI,MAAM,CAAC,aAAa,EAAE;QACxB,OAAO,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;KACtC;IAED,IAAI,MAAM,CAAC,aAAa,IAAI,OAAO,CAAC,OAAO,EAAE;QAC3C,IAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACxC,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;KAC5D;IAED,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;;ACXF,IAAM,QAAQ,GAAG,UAAC,QAAa;IAC7B,IAAM,WAAW,GAAG,QAAQ,CAAC,WAAW,IAAI,EAAE,CAAC;IAC/C,IAAM,cAAc,GAAG,QAAQ,CAAC,cAAc,IAAI,eAAe,CAAC,cAAc,CAAC;IACjF,IAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,IAAI,eAAe,CAAC,MAAM,CAAC;IAEzD,IAAM,MAAM,GAAG,+BACV,eAAe,GACf,QAAQ,KACX,WAAW,aAAA,EACX,cAAc,EAAE,WAAW,CAAC,MAAM,CAAC,IAAI,cAAc,EACrD,IAAI,EAAE,QAAQ,CAAC,IAAI,IAAI,eAAe,CAAC,IAAI,GACrC,CAAC;IAET,OAAO,EAAE,MAAM,QAAA,EAAE,CAAC;AACpB,CAAC,CAAC;AAEI,IAAA,KAAwCA,oBAAe,CAAC;IAC5D,GAAG,EAAE,IAAI;IACT,QAAQ,UAAA;IACR,GAAG,EAAE,EAAE,OAAO,SAAA,EAAE;CACjB,CAAC,EAJM,cAAc,oBAAA,EAAE,iBAAiB,uBAIvC;;;;;"}